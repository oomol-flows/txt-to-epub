# TXT转EPUB转换器 - 雅致样式版

一个用于将TXT格式文本文件转换为EPUB电子书的工具，具有优雅的字体排版设计。

## 核心特性

### 🎨 雅致样式设计
灵感来源于多平台电子阅读器的专业排版样式，提供：

- **分级标题系统**
  - 卷/部/册标题：使用小标宋字体配合装饰线条和渐变效果
  - 章节标题：居中对齐，底部装饰符号
  - 小节标题：左侧彩色边框配合渐变背景效果

- **优雅字体搭配**
  - 正文：宋体系字体（DK-SONGTI、方正书宋三号、方正书宋等）
  - 标题：小标宋字体（DK-XIAOBIAOSONG、方正小标宋、等）
  - 强调：黑体系字体（DK-HEITI、方正兰亭黑等）
  - 引用：楷体系字体（DK-KAITI、方正楷体、华文楷体等）

- **专业配色方案**
  - 主色调：#91531d（温暖棕色）
  - 章节标题：#1f4a92（深蓝色）
  - 小节标题：#478686（青绿色）
  - 正文：#2c2c2c（深灰色）

- **精美视觉元素**
  - 装饰分割线和符号
  - 渐变背景和阴影效果
  - 适应不同屏幕尺寸的响应式设计
  - 优化的中文排版

### 📚 智能文本解析
- **三级层次结构**：自动识别 卷/部/册 → 章 → 节
- **灵活标题格式**：支持数字和中文数字（包括繁体）
- **智能编码检测**：自动处理GB18030、GBK、UTF-8等编码

### 🛠️ 使用方法

#### 基础用法
```python
from tasks.txt_to_epub import txt_to_epub

txt_to_epub(
    txt_file="input.txt",
    epub_file="output.epub",
    title="我的书",
    author="作者姓名",
    cover_image="cover.jpg"  # 可选
)
```

#### 作为工作流任务
```python
from tasks.txt_to_epub import main
from oocana import Context

params = {
    'txt_file': 'input.txt',
    'epub_dir': 'output/',
    'book_title': '我的书',      # 可选
    'author': '作者姓名',        # 可选
    'cover_image': 'cover.jpg'   # 可选
}

result = main(params, Context())
```

### 📖 支持的文本格式

#### 标题识别模式
- **卷级标题**：第一卷/第一部/第一册 + 标题
- **章级标题**：第一章 + 标题
- **节级标题**：第一节 + 标题

#### 示例文本结构
```
第一卷：开篇

第一章：开始
这是章节内容...

第一节：人物介绍
这是小节内容...

第二节：背景设定
这是另一个小节的内容...

第二章：发展
这是没有子节的章节内容...
```

### 🎨 样式特色

#### 卷标题样式
- 小标宋字体，2.4em大小
- 温暖棕色主题（#91531d）
- 底部装饰线条配合渐变效果
- 居中对齐，上下留有充足边距

#### 章标题样式
- 小标宋字体，2em大小
- 深蓝色主题（#1f4a92）
- 底部边框线配合装饰符号
- 居中对齐，优雅间距

#### 节标题样式
- 黑体，1.4em大小
- 青绿色主题（#478686）
- 左侧彩色边框配合渐变背景
- 左对齐，前缀装饰符号

#### 正文样式
- 宋体16px，行高1.8
- 首行缩进2字符
- 两端对齐，优化间距
- 深灰色文字（#2c2c2c）

### 📱 响应式设计
- 平板设备适配（768px以下）
- 手机设备适配（480px以下）
- 打印样式优化
- 中文排版优化

### 🔧 技术特性
- **自动编码检测**：支持GB18030、GBK、UTF-8等
- **错误处理**：完善的异常处理和日志记录
- **内存优化**：高效的文本处理和EPUB生成
- **标准兼容**：符合EPUB 3.0标准

### 📦 依赖项
```
EbookLib==0.18
chardet==5.2.0
```

### 🚀 快速测试
运行测试脚本生成示例EPUB：
```bash
python test_epub_generation.py
```

### 💡 样式灵感
本工具的样式设计灵感来源于：
- [多看阅读的CSS模板](https://github.com/Eninix/sigil-template)
- 专业出版排版标准
- 现代电子书视觉设计趋势

生成的EPUB文件在支持CSS的阅读器中会显示最佳视觉效果，尤其是在支持多看格式的应用中，如小米阅读器。