inputs_def:
  - handle: txt_file
    description: "Path to the TXT file to convert"
    json_schema:
      type: string
      ui:widget: file
  - handle: epub_dir
    description: "Directory where the EPUB file will be saved"
    json_schema:
      type: string
      ui:widget: dir
  - handle: book_title
    description: "Book title (optional, auto-detected if not provided)"
    json_schema:
      type: string
    value:
    nullable: true
  - handle: author
    description: "Author name (optional, auto-detected if not provided)"
    json_schema:
      type: string
    value:
    nullable: true
  - handle: cover_image
    description: "Cover image file path (optional)"
    json_schema:
      type: string
      ui:widget: file
    value:
    nullable: true
  - group: Smart TOC Analysis
    collapsed: true
  - handle: enable_smart_toc
    description: "Enable LLM-powered smart TOC analysis"
    json_schema:
      type: boolean
    value: false
    nullable: false
  - handle: llm_confidence_threshold
    description: "Confidence threshold for LLM trigger (0.0-1.0, lower = more often)"
    json_schema:
      type: number
      minimum: 0
      maximum: 1
    value: 0.7
    nullable: false
  - handle: llm_toc_detection_threshold
    description: "LLM confidence threshold for confirming TOC exists (0.0-1.0)"
    json_schema:
      type: number
      minimum: 0
      maximum: 1
    value: 0.7
    nullable: false
  - handle: llm_no_toc_threshold
    description: "LLM confidence threshold for confirming no TOC (0.0-1.0)"
    json_schema:
      type: number
      minimum: 0
      maximum: 1
    value: 0.8
    nullable: false
  - handle: toc_detection_score_threshold
    description: "Minimum score for TOC detection (0-100, higher = stricter)"
    json_schema:
      type: number
      minimum: 0
      maximum: 100
    value: 30
    nullable: false
  - handle: toc_max_scan_lines
    description: "Maximum lines to scan for TOC detection (50-1000)"
    json_schema:
      type: integer
      minimum: 50
      maximum: 1000
    value: 300
    nullable: false
  - handle: llm
    description: "LLM model configuration"
    json_schema:
      ui:options:
        title: Model
      ui:widget: llm::model
    value:
      model: oomol-chat
      temperature: 0
      top_p: 0.5
      max_tokens: 128000
outputs_def:
  - handle: epub_file
    description: "Generated EPUB file path"
    json_schema:
      type: string
      ui:widget: file
ui:
  default_width: 450
executor:
  name: python
  options:
    spawn: false
    entry: __init__.py
title: Txt To Epub Core
icon: ":twemoji:blue-book:"
applet: true
description: "Converts TXT book files to EPUB format with smart TOC detection
  and optional LLM-powered analysis"
private: true
